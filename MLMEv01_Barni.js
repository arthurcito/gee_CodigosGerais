/*
* O primeiro trecho do código trata dos arquivos de entrada na caixa de "IMPORTS"
*/



var imageVisParam = {"opacity":1,"bands":["SR_B4","SR_B3","SR_B2"],"min":7737,"max":15167,"gamma":1.4960000000000002},
    table = ee.FeatureCollection("users/arthurcito/Barni_AreaEstudo"),
    veg_em = 
    /* color: #14d60c */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.MultiPolygon(
        [[[[-60.319339017915674, 0.7264548522193391],
           [-60.319339017915674, 0.723622666276337],
           [-60.31590579037661, 0.723622666276337],
           [-60.31590579037661, 0.7264548522193391]]],
         [[[-60.30796645169253, 0.7315613648080009],
           [-60.30796645169253, 0.7273560019201732],
           [-60.3036749172687, 0.7273560019201732],
           [-60.3036749172687, 0.7315613648080009]]],
         [[[-60.36809084897036, 0.7361100181877525],
           [-60.36809084897036, 0.7297590669087886],
           [-60.36281226162905, 0.7297590669087886],
           [-60.36281226162905, 0.7361100181877525]]],
         [[[-60.252209111425614, 0.5715801448415604],
           [-60.252209111425614, 0.5638557620873306],
           [-60.24431268808577, 0.5638557620873306],
           [-60.24431268808577, 0.5715801448415604]]],
         [[[-60.23538629648421, 0.5508101146827239],
           [-60.23538629648421, 0.5415408215022625],
           [-60.22577325937483, 0.5415408215022625],
           [-60.22577325937483, 0.5508101146827239]]],
         [[[-60.3255085193846, 0.5750132005170551],
           [-60.3255085193846, 0.5696919633445207],
           [-60.32053033945296, 0.5696919633445207],
           [-60.32053033945296, 0.5750132005170551]]],
         [[[-60.33477823374007, 0.542914051021835],
           [-60.33477823374007, 0.5338163996808979],
           [-60.324821873876786, 0.5338163996808979],
           [-60.324821873876786, 0.542914051021835]]],
         [[[-60.56334535715315, 0.559821913677735],
           [-60.56334535715315, 0.5541573559120493],
           [-60.556822224828935, 0.5541573559120493],
           [-60.556822224828935, 0.559821913677735]]],
         [[[-60.5452350818846, 0.5640274151492893],
           [-60.5452350818846, 0.5581053815967842],
           [-60.53888361093733, 0.5581053815967842],
           [-60.53888361093733, 0.5640274151492893]]],
         [[[-60.604715748998856, 0.5592211275064799],
           [-60.604715748998856, 0.5530416090451976],
           [-60.5975918018553, 0.5530416090451976],
           [-60.5975918018553, 0.5592211275064799]]],
         [[[-60.57026875711792, 0.4678072486127655],
           [-60.57026875711792, 0.46149890046124153],
           [-60.56464684702271, 0.46149890046124153],
           [-60.56464684702271, 0.4678072486127655]]],
         [[[-60.53589356638306, 0.46355876986428524],
           [-60.53589356638306, 0.45845200920966045],
           [-60.53108704782837, 0.45845200920966045],
           [-60.53108704782837, 0.46355876986428524]]],
         [[[-60.544613514498096, 0.8622229006848989],
           [-60.544613514498096, 0.8590475234723252],
           [-60.54075113351665, 0.8590475234723252],
           [-60.54075113351665, 0.8622229006848989]]],
         [[[-60.58246484811626, 0.856644533556912],
           [-60.58246484811626, 0.8544990055732238],
           [-60.578087483003955, 0.8544990055732238],
           [-60.578087483003955, 0.856644533556912]]],
         [[[-60.498179112032275, 0.8632527521855402],
           [-60.498179112032275, 0.8612788698979134],
           [-60.496205006197314, 0.8612788698979134],
           [-60.496205006197314, 0.8632527521855402]]],
         [[[-60.5354296308311, 0.8851370301055944],
           [-60.5354296308311, 0.8826482363199923],
           [-60.53233972604595, 0.8826482363199923],
           [-60.53233972604595, 0.8851370301055944]]],
         [[[-60.6062813568659, 0.8076778383152353],
           [-60.6062813568659, 0.8018419272086497],
           [-60.60005863195135, 0.8018419272086497],
           [-60.60005863195135, 0.8076778383152353]]],
         [[[-60.62696655278875, 0.7995676360654227],
           [-60.62696655278875, 0.795791451763709],
           [-60.62177379613592, 0.795791451763709],
           [-60.62177379613592, 0.7995676360654227]]],
         [[[-60.57846512528338, 0.773047444943751],
           [-60.57846512528338, 0.7664390783425259],
           [-60.57022537918963, 0.7664390783425259],
           [-60.57022537918963, 0.773047444943751]]],
         [[[-60.51580872269549, 0.7654092021074742],
           [-60.51580872269549, 0.7602598172291974],
           [-60.5080839607326, 0.7602598172291974],
           [-60.5080839607326, 0.7654092021074742]]],
         [[[-60.341871215151684, 0.8692173574202443],
           [-60.341871215151684, 0.8650979562160673],
           [-60.338352156924145, 0.8650979562160673],
           [-60.338352156924145, 0.8692173574202443]]],
         [[[-60.34916682367219, 0.8378926328000901],
           [-60.34916682367219, 0.8314560142217161],
           [-60.34367365960969, 0.8314560142217161],
           [-60.34367365960969, 0.8378926328000901]]],
         [[[-60.23053269079315, 0.7865964352416084],
           [-60.23053269079315, 0.7820478349652629],
           [-60.226326987057796, 0.7820478349652629],
           [-60.226326987057796, 0.7865964352416084]]],
         [[[-60.249844595700374, 0.8128580673028181],
           [-60.249844595700374, 0.8086527846205771],
           [-60.246325537472835, 0.8086527846205771],
           [-60.246325537472835, 0.8128580673028181]]],
         [[[-60.276022955685725, 0.7908875630335173],
           [-60.276022955685725, 0.7858240317697752],
           [-60.2717314212619, 0.7858240317697752],
           [-60.2717314212619, 0.7908875630335173]]],
         [[[-60.30829529455291, 0.7888278222456038],
           [-60.30829529455291, 0.7845366923327357],
           [-60.30408959081756, 0.7845366923327357],
           [-60.30408959081756, 0.7888278222456038]]]], null, false),
    agua_em = 
    /* color: #101dff */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.MultiPolygon(
        [[[[-60.62713624843011, 0.9010508798576924],
           [-60.62713624843011, 0.9008148746437411],
           [-60.6269002140368, 0.9008148746437411],
           [-60.6269002140368, 0.9010508798576924]]],
         [[[-60.625805872758725, 0.9000639488613688],
           [-60.625805872758725, 0.8999137636863249],
           [-60.62546255000482, 0.8999137636863249],
           [-60.62546255000482, 0.9000639488613688]]],
         [[[-60.63069822200189, 0.901780350422266],
           [-60.63069822200189, 0.901651620333257],
           [-60.6304836452807, 0.901651620333257],
           [-60.6304836452807, 0.901780350422266]]],
         [[[-60.61197736882736, 0.5144460726059479],
           [-60.61197736882736, 0.5143602453766458],
           [-60.611848622794646, 0.5143602453766458],
           [-60.611848622794646, 0.5144460726059479]]],
         [[[-60.60931661748459, 0.5139096524038544],
           [-60.60931661748459, 0.5137594547391795],
           [-60.60920932912399, 0.5137594547391795],
           [-60.60920932912399, 0.5139096524038544]]],
         [[[-60.60768583440353, 0.5125578732948376],
           [-60.60768583440353, 0.512450589226341],
           [-60.60757854604294, 0.512450589226341],
           [-60.60757854604294, 0.5125578732948376]]],
         [[[-60.6060765089946, 0.5133088617239976],
           [-60.6060765089946, 0.5130728367986223],
           [-60.605969220634, 0.5130728367986223],
           [-60.605969220634, 0.5133088617239976]]],
         [[[-60.60472467565109, 0.5146820974805997],
           [-60.60472467565109, 0.5146391838676662],
           [-60.604424268241424, 0.5146391838676662],
           [-60.604424268241424, 0.5146820974805997]]],
         [[[-60.599124223227996, 0.5153043448355091],
           [-60.599124223227996, 0.5151970608131305],
           [-60.598673612113494, 0.5151970608131305],
           [-60.598673612113494, 0.5153043448355091]]],
         [[[-60.53376225549298, 0.48714916828809113],
           [-60.53376225549298, 0.4868487717298894],
           [-60.53361205178815, 0.4868487717298894],
           [-60.53361205178815, 0.48714916828809113]]],
         [[[-60.52150992471295, 0.48867260776971155],
           [-60.52150992471295, 0.4883936681721254],
           [-60.52131680566388, 0.4883936681721254],
           [-60.52131680566388, 0.48867260776971155]]],
         [[[-60.519664564910705, 0.4865912889550735],
           [-60.519664564910705, 0.486290892372038],
           [-60.51934269982892, 0.486290892372038],
           [-60.51934269982892, 0.4865912889550735]]],
         [[[-60.51822690087872, 0.48517513351807],
           [-60.51822690087872, 0.484874736872085],
           [-60.51796940881329, 0.484874736872085],
           [-60.51796940881329, 0.48517513351807]]],
         [[[-60.51723984796124, 0.48438122806760514],
           [-60.51723984796124, 0.4841666590109736],
           [-60.51706818658429, 0.4841666590109736],
           [-60.51706818658429, 0.48438122806760514]]],
         [[[-60.528419295135315, 0.49090412413292167],
           [-60.528419295135315, 0.49071101216934393],
           [-60.52811888772565, 0.49071101216934393],
           [-60.52811888772565, 0.49090412413292167]]],
         [[[-60.49297109825384, 0.4848083198047727],
           [-60.49297109825384, 0.48431481099545837],
           [-60.49245611412298, 0.48431481099545837],
           [-60.49245611412298, 0.4848083198047727]]],
         [[[-60.488851225206965, 0.486288846016756],
           [-60.488851225206965, 0.48598844942026037],
           [-60.48863664848577, 0.48598844942026037],
           [-60.48863664848577, 0.486288846016756]]],
         [[[-60.48689857704412, 0.48776937190404285],
           [-60.48689857704412, 0.4875548029550285],
           [-60.48676983101141, 0.4875548029550285],
           [-60.48676983101141, 0.48776937190404285]]],
         [[[-60.48929011655331, 0.4959203289614694],
           [-60.48929011655331, 0.49566284653619647],
           [-60.488968251471526, 0.49566284653619647],
           [-60.488968251471526, 0.4959203289614694]]],
         [[[-60.30812447275948, 0.5450504971022224],
           [-60.30812447275948, 0.5444711661416416],
           [-60.30756657328438, 0.5444711661416416],
           [-60.30756657328438, 0.5450504971022224]]],
         [[[-60.34782504297743, 0.5585613299126272],
           [-60.34782504297743, 0.5582823934237406],
           [-60.34761046625624, 0.5582823934237406],
           [-60.34761046625624, 0.5585613299126272]]],
         [[[-59.6497929962778, -0.8479768590596365],
           [-59.6497929962778, -0.8492641781727789],
           [-59.64859136663913, -0.8492641781727789],
           [-59.64859136663913, -0.8479768590596365]]],
         [[[-59.63957914434909, -0.8495216419439842],
           [-59.63957914434909, -0.8507231393159863],
           [-59.63863500677585, -0.8507231393159863],
           [-59.63863500677585, -0.8495216419439842]]],
         [[[-59.63606008612155, -0.8481485016328129],
           [-59.63606008612155, -0.8490067143844368],
           [-59.635287609925264, -0.8490067143844368],
           [-59.635287609925264, -0.8481485016328129]]],
         [[[-59.66764577948093, -0.8299543468210999],
           [-59.66764577948093, -0.8307267418998436],
           [-59.66687330328464, -0.8307267418998436],
           [-59.66687330328464, -0.8299543468210999]]],
         [[[-59.66206678472995, -0.8393947207298296],
           [-59.66206678472995, -0.8404245783276324],
           [-59.66138013922214, -0.8404245783276324],
           [-59.66138013922214, -0.8393947207298296]]],
         [[[-59.655715313782686, -0.8458313262534132],
           [-59.655715313782686, -0.8465178968805988],
           [-59.65511449896335, -0.8465178968805988],
           [-59.65511449896335, -0.8458313262534132]]],
         [[[-59.656487789978975, -0.8503798543907074],
           [-59.656487789978975, -0.8517529939085211],
           [-59.6552861603403, -0.8517529939085211],
           [-59.6552861603403, -0.8503798543907074]]],
         [[[-59.65717443548679, -0.8536410599465152],
           [-59.65717443548679, -0.8548425560336113],
           [-59.655972805848116, -0.8548425560336113],
           [-59.655972805848116, -0.8536410599465152]]],
         [[[-59.69682821356296, -0.8251483296139851],
           [-59.69682821356296, -0.8263498344614102],
           [-59.69562658392429, -0.8263498344614102],
           [-59.69562658392429, -0.8251483296139851]]],
         [[[-59.673997250428194, -0.826864764999089],
           [-59.673997250428194, -0.8278946258740336],
           [-59.67305311285495, -0.8278946258740336],
           [-59.67305311285495, -0.826864764999089]]],
         [[[-59.72467872243017, -0.7865200380046332],
           [-59.72467872243017, -0.7879790219768825],
           [-59.72364875416845, -0.7879790219768825],
           [-59.72364875416845, -0.7865200380046332]]],
         [[[-59.714293209124506, -0.8120092720076064],
           [-59.714293209124506, -0.813124958750283],
           [-59.71343490223974, -0.813124958750283],
           [-59.71343490223974, -0.8120092720076064]]],
         [[[-59.74038573842138, -0.7864342154021223],
           [-59.74038573842138, -0.7878073768301793],
           [-59.739012447405756, -0.7878073768301793],
           [-59.739012447405756, -0.7864342154021223]]],
         [[[-60.88924890251507, -0.6447401840852385],
           [-60.88924890251507, -0.6449547472165094],
           [-60.8889484951054, -0.6449547472165094],
           [-60.8889484951054, -0.6447401840852385]]],
         [[[-60.8715677806889, -0.6380887225457366],
           [-60.8715677806889, -0.6383891113174823],
           [-60.87131028862347, -0.6383891113174823],
           [-60.87131028862347, -0.6380887225457366]]],
         [[[-60.86457257957806, -0.6433669798310763],
           [-60.86457257957806, -0.6436673682932779],
           [-60.86431508751263, -0.6436673682932779],
           [-60.86431508751263, -0.6433669798310763]]],
         [[[-60.89946275444378, -0.6400627055814658],
           [-60.89946275444378, -0.6402772689091805],
           [-60.899119431689876, -0.6402772689091805],
           [-60.899119431689876, -0.6400627055814658]]],
         [[[-60.64493696367259, 0.575709360259591],
           [-60.64493696367259, 0.5745936175269133],
           [-60.64403574144359, 0.5745936175269133],
           [-60.64403574144359, 0.575709360259591]]],
         [[[-60.6537318561025, 0.6026160877025881],
           [-60.6537318561025, 0.6021869579796919],
           [-60.65347436403707, 0.6021869579796919],
           [-60.65347436403707, 0.6026160877025881]]],
         [[[-60.64639333223776, 0.6114132395374222],
           [-60.64639333223776, 0.6095250715708438],
           [-60.6458783481069, 0.6095250715708438],
           [-60.6458783481069, 0.6114132395374222]]],
         [[[-60.60557451959263, 0.5797380981518505],
           [-60.60557451959263, 0.579437706112072],
           [-60.60538140054356, 0.579437706112072],
           [-60.60538140054356, 0.5797380981518505]]],
         [[[-60.603686244446145, 0.5774422443009259],
           [-60.603686244446145, 0.5772920482222538],
           [-60.603407294708596, 0.5772920482222538],
           [-60.603407294708596, 0.5774422443009259]]],
         [[[-60.603428752380715, 0.5754253251994174],
           [-60.603428752380715, 0.575017649975171],
           [-60.603149802643166, 0.575017649975171],
           [-60.603149802643166, 0.5754253251994174]]],
         [[[-60.32462722931498, 0.8365638833180946],
           [-60.32462722931498, 0.8358344001619341],
           [-60.323897668462926, 0.8358344001619341],
           [-60.323897668462926, 0.8365638833180946]]],
         [[[-60.315958329778844, 0.8424426543809056],
           [-60.315958329778844, 0.8417560830342022],
           [-60.31505710754984, 0.8417560830342022],
           [-60.31505710754984, 0.8424426543809056]]],
         [[[-60.256694022393795, 0.861366042588891],
           [-60.256694022393795, 0.8608940271184861],
           [-60.256179038262935, 0.8608940271184861],
           [-60.256179038262935, 0.861366042588891]]],
         [[[-60.25579280016479, 0.8602932800716538],
           [-60.25579280016479, 0.8595638013876458],
           [-60.25510615465698, 0.8595638013876458],
           [-60.25510615465698, 0.8602932800716538]]],
         [[[-60.35531687401438, 0.8118893662927926],
           [-60.35531687401438, 0.8112886117475101],
           [-60.354630228506565, 0.8112886117475101],
           [-60.354630228506565, 0.8118893662927926]]],
         [[[-60.353900667654514, 0.8109024123498737],
           [-60.353900667654514, 0.8103874797623656],
           [-60.35342859886789, 0.8103874797623656],
           [-60.35342859886789, 0.8109024123498737]]],
         [[[-60.35295653008127, 0.8100441913343291],
           [-60.35295653008127, 0.8095721696983045],
           [-60.35257029198313, 0.8095721696983045],
           [-60.35257029198313, 0.8100441913343291]]],
         [[[-60.45804811273852, 0.8157918699061556],
           [-60.45804811273852, 0.8150194719356643],
           [-60.45721126352587, 0.8150194719356643],
           [-60.45721126352587, 0.8157918699061556]]],
         [[[-60.45053792749682, 0.8169933775654964],
           [-60.45053792749682, 0.8161566133406876],
           [-60.45000148569384, 0.8161566133406876],
           [-60.45000148569384, 0.8169933775654964]]],
         [[[-60.44965816293993, 0.8183450732527623],
           [-60.44965816293993, 0.8179374190457994],
           [-60.449336297858146, 0.8179374190457994],
           [-60.449336297858146, 0.8183450732527623]]],
         [[[-60.44856382166186, 0.8189672822255901],
           [-60.44856382166186, 0.8186025390463169],
           [-60.44824195658007, 0.8186025390463169],
           [-60.44824195658007, 0.8189672822255901]]],
         [[[-60.39250856569265, 0.8434736236028362],
           [-60.39250856569265, 0.8429586952404277],
           [-60.39182192018484, 0.8429586952404277],
           [-60.39182192018484, 0.8434736236028362]]]], null, false),
    solo_em = 
    /* color: #fffd0a */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.MultiPolygon(
        [[[[-60.434762944022665, 0.9064965814645735],
           [-60.434762944022665, 0.9059441155178601],
           [-60.43447326544906, 0.9059441155178601],
           [-60.43447326544906, 0.9064965814645735]]],
         [[[-60.43471470983105, 0.901095752878334],
           [-60.43471470983105, 0.900076639357573],
           [-60.43359891088085, 0.900076639357573],
           [-60.43359891088085, 0.901095752878334]]],
         [[[-60.53978363148252, 0.9875729428666767],
           [-60.53978363148252, 0.9872296710932587],
           [-60.53939739338438, 0.9872296710932587],
           [-60.53939739338438, 0.9875729428666767]]],
         [[[-60.53961197010557, 0.9787336834390712],
           [-60.53961197010557, 0.97843331984424],
           [-60.53935447804014, 0.97843331984424],
           [-60.53935447804014, 0.9787336834390712]]],
         [[[-60.580755095825396, 0.788541565560937],
           [-60.580755095825396, 0.7881875474859336],
           [-60.58040104423543, 0.7881875474859336],
           [-60.58040104423543, 0.788541565560937]]],
         [[[-60.45566771154976, 0.7539904475214656],
           [-60.45566771154976, 0.7536900661126529],
           [-60.455463863664626, 0.7536900661126529],
           [-60.455463863664626, 0.7539904475214656]]],
         [[[-60.45462701445198, 0.7561789400166818],
           [-60.45462701445198, 0.7559214703685622],
           [-60.45440170889473, 0.7559214703685622],
           [-60.45440170889473, 0.7561789400166818]]],
         [[[-60.44268660738279, 0.6542854580763166],
           [-60.44268660738279, 0.6537812356341535],
           [-60.442278911612526, 0.6537812356341535],
           [-60.442278911612526, 0.6542854580763166]]],
         [[[-60.254601366124845, 0.6020180167909019],
           [-60.254601366124845, 0.6017390824442715],
           [-60.25440824707577, 0.6017390824442715],
           [-60.25440824707577, 0.6020180167909019]]],
         [[[-60.246876604161955, 0.6004087799796107],
           [-60.246876604161955, 0.600215671530406],
           [-60.246704942785, 0.600215671530406],
           [-60.246704942785, 0.6004087799796107]]],
         [[[-60.2436794110162, 0.5999367370917303],
           [-60.2436794110162, 0.5997221721292233],
           [-60.243593580327726, 0.5997221721292233],
           [-60.243593580327726, 0.5999367370917303]]],
         [[[-60.11918142703382, -0.751794807403664],
           [-60.11918142703382, -0.7521381005898357],
           [-60.118859561952036, -0.7521381005898357],
           [-60.118859561952036, -0.751794807403664]]],
         [[[-60.131090435059946, -0.7499710618998575],
           [-60.131090435059946, -0.7506147368704145],
           [-60.13042524722425, -0.7506147368704145],
           [-60.13042524722425, -0.7499710618998575]]],
         [[[-60.13254955676405, -0.7524170262837162],
           [-60.13254955676405, -0.7529105101599753],
           [-60.132077487977426, -0.7529105101599753],
           [-60.132077487977426, -0.7524170262837162]]],
         [[[-60.12853697207777, -0.753768742855191],
           [-60.12853697207777, -0.7540905800723042],
           [-60.12815073397962, -0.7540905800723042],
           [-60.12815073397962, -0.753768742855191]]],
         [[[-60.11355951693861, -0.7524813937490109],
           [-60.11355951693861, -0.7529534217987512],
           [-60.11328056720106, -0.7529534217987512],
           [-60.11328056720106, -0.7524813937490109]]],
         [[[-60.10795906451551, -0.7565365421440142],
           [-60.10795906451551, -0.7569012907559675],
           [-60.10768011477796, -0.7569012907559675],
           [-60.10768011477796, -0.7565365421440142]]],
         [[[-60.095642360719125, -0.754669887003133],
           [-60.095642360719125, -0.7553564728953144],
           [-60.09506300357191, -0.7553564728953144],
           [-60.09506300357191, -0.754669887003133]]],
         [[[-60.091694149049204, -0.7510653092934513],
           [-60.091694149049204, -0.7515587933225043],
           [-60.09126499560682, -0.7515587933225043],
           [-60.09126499560682, -0.7510653092934513]]],
         [[[-60.09285286334364, -0.7568798349561144],
           [-60.09285286334364, -0.7573947741233252],
           [-60.09246662524549, -0.7573947741233252],
           [-60.09246662524549, -0.7568798349561144]]],
         [[[-60.098131450684946, -0.7544553288895942],
           [-60.098131450684946, -0.7548629892962724],
           [-60.09780958560316, -0.7548629892962724],
           [-60.09780958560316, -0.7544553288895942]]],
         [[[-60.691637617144856, -0.2105319464381528],
           [-60.691637617144856, -0.2108752668705462],
           [-60.69133720973519, -0.2108752668705462],
           [-60.69133720973519, -0.2105319464381528]]]], null, false),
    imageVisParamAgua = {"opacity":1,"bands":["band_0"],"min":-0.3579150389280943,"max":1.8010535100571938,"gamma":0.996},
    imageVisParamSolo = {"opacity":1,"bands":["band_1"],"min":-0.10424282920761674,"max":0.9290960011897251,"gamma":1},
    imageVisParamVegetacao = {"opacity":1,"bands":["band_2"],"min":0.21825402534303484,"max":1.218642797515565,"gamma":1};


/* 
* AQUI ENCERRA O TRECHO DE ARQUIVOS DE ENTRADA E INICIA O SCRIPT DO CÓDIGO EM SI.
*/



/*
* O Script foi dividido em tres partes:
* 1- Adicao de um mapa base para auxiliar na escolha das amostras
* para calculo dos endmembers;
* 2- Adicao da cena Landsat8 alvo, com destaque para a area de estudo;
* 3- Codigo com aplicacao do Modelo Linear de Mistura Espectral
* este codigo foi baseado na aula do Prof. Dr. Luis Sadeck
* (link: https://www.youtube.com/watch?v=v29Sx5QcDxE&t=320s);
*/



//-------1 - Mapa Base: Planet-------//
// This collection is not publicly accessible. To sign up for access,
// please see https://developers.planet.com/docs/integrations/gee/nicfi
var nicfi = ee.ImageCollection('projects/planet-nicfi/assets/basemaps/americas');

// Filter basemaps by date and get the first image from filtered results
var basemap= nicfi.filter(ee.Filter.date('2023-11-01','2023-12-01')).first();

Map.centerObject(table,10);

var vis = {'bands':['R','G','B'],'min':64,'max':5454,'gamma':1.8};

Map.addLayer(basemap, vis, 'Planet - Nov 2023 Mosaic');
Map.addLayer(
    basemap.normalizedDifference(['N','R']).rename('NDVI'),
    {min:-0.55,max:0.8,palette: [
        '8bc4f9', 'c9995c', 'c7d270','8add60','097210'
    ]}, 'NDVI - Planet (Nov 2023)', false);



//-------2 - Imagem Landsat8 Alvo-------//
var l8img = ee.Image('LANDSAT/LC08/C02/T1_L2/LC08_231060_20231120')

//Map.setCenter(-60.4753, 0.6961, 10);
Map.addLayer(l8img,imageVisParam, 'Barni_Landsat8_20nov2023');
Map.addLayer(table.style({color:'black', fillColor:'ff000000'}), {}, "Área de Estudo");



//-------3 - Script do MLME-------//
var l8Bandas = ee.Image('LANDSAT/LC08/C02/T1_L2/LC08_231060_20231120')
    .select('SR_B2', 'SR_B3', 'SR_B4', 'SR_B5', 'SR_B6');

var veg = l8Bandas.reduceRegion(ee.Reducer.mean(), veg_em, 30).values();
var solo = l8Bandas.reduceRegion(ee.Reducer.mean(), solo_em, 30).values();
var agua_sombra = l8Bandas.reduceRegion(ee.Reducer.mean(), agua_em, 30).values();

var mlme = l8Bandas.unmix([agua_sombra, solo, veg]);

Map.addLayer(mlme, {}, "MLME");

Map.addLayer(mlme.select(0), imageVisParamAgua, "Água/Sombra - Imagem Fração");
Map.addLayer(mlme.select(1), imageVisParamSolo, "Solo - Imagem Fração");
Map.addLayer(mlme.select(2), imageVisParamVegetacao, "Vegetacao - Imagem Fração");

Map.addLayer(table.style({color:'white', fillColor:'ff000000'}), {}, "Área de Estudo");
